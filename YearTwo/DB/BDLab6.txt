-- 1. 

select 
    dateadd(month, 2, data) as data_plus_2_months,
    dateadd(month, -3, data) as data_minus_3_months
from sale;

-- 2.

select 
    sp_name, 
    sp_surname 
from employee
where sale_date < '2011-02-20';

-- 3.

select 
    datediff(day, getdate(), datefromparts(year(getdate()), 12, 25)) as days_until_christmas;

-- 4. 

select 
    datename(weekday, dateadd(day, 2, getdate())) as day_after_tomorrow;

-- 5. Округлить до целого с избытком и недостатком значения столбца cost.
select 
    floor(cost) as rounded_down, 
    ceiling(cost) as rounded_up
from sale;

-- 6. 

select 
    datename(month, sale_date) as sale_month
from sale;

-- 7. 

select 
    sale_date,
    datediff(year, sale_date, getdate()) as years_since_sale,
    datediff(month, sale_date, getdate()) % 12 as months_since_sale
from sale;

-- 8. 

select 
    sp_surname
from employee;

-- 9. 

select 
    sp_name
from employee;

-- 10. 

select 
    concat('firma - ', m_name) as firm_name
from manufact;

-- 11.

select 
    isnull(man_id, 0) as man_id
from sperson;

-- 12. 

select 
    p_desc
from product
where mod(price, 0.6) = 0;

-- 13.

select 
    upper(p_desc) as uppercase_desc, 
    lower(p_desc) as lowercase_desc
from product;

-- 14. 

select 
    lpad(c_name, 15, '_') as formatted_c_name
from customer;

-- 15. 

select 
    rpad(c_name, 15, '_') as formatted_c_name
from customer;

-- 16.

select 
    replace(country, 'us', '') as modified_country
from country;

-- 17. 

select 
    replace(sp_name, 'an', '') as modified_sp_name
from sperson;

-- 18.

select 
    replace(sp_name, 'an', '_n') as modified_sp_name
from sperson;

-- 19. 

select 
    substr(p_desc, 4, 3) as part_desc
from product;

-- 20. 

select 
    substr(p_desc, 7) as tail_desc
from product;

-- 21. 

select 
    substr(ssn, 1, 3) || '-' || substr(ssn, 4, 2) || '-' || substr(ssn, 6) as formatted_ssn
from cod_ssn;

-- 22. 

select 
    instr(sp_name, 'o') as first_o_position
from sperson;

-- 23. 

select 
    instr(sp_name, 'o', 2, 2) as second_o_position
from sperson;

-- 24. 

select 
    instr(sp_name, 'o', 3, 2) as second_o_position_from_third
from sperson;

-- 25. 

select 
    length(sp_name) as name_length
from sperson;
